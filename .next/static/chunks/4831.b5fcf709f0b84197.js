(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4831],{30509:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return y}});var a=r(85893),l=r(5152),t=r.n(l),d=r(88767),o=r(1612),i=r(67294),u=r(2950),s=r(18074),c=r(80129),p=r.n(c),v=r(34349),f=r(64698),g=r(11163);let b=t()(()=>Promise.resolve().then(r.bind(r,37935)),{loadableGenerated:{webpack:()=>[37935]}}),h=t()(()=>r.e(520).then(r.bind(r,20520)),{loadableGenerated:{webpack:()=>[20520]}}),m=t()(()=>Promise.all([r.e(9072),r.e(8347)]).then(r.bind(r,98347)),{loadableGenerated:{webpack:()=>[98347]}}),w=t()(()=>Promise.all([r.e(110),r.e(9072),r.e(2175),r.e(7022),r.e(1018),r.e(5630),r.e(5584)]).then(r.bind(r,16515)),{loadableGenerated:{webpack:()=>[16515]}});function y(){var e;let{t:n,locale:r}=(0,s.Z)(),l=(0,i.useRef)(null),t=(0,u.Z)(),c=(0,v.C)(f.j),{query:y}=(0,g.useRouter)(),k=null==y?void 0:y.filter,{data:x,error:_,fetchNextPage:j,hasNextPage:P,isFetchingNextPage:C,isLoading:G}=(0,d.useInfiniteQuery)(["popularShopsPaginate",r,t,c,k,null==y?void 0:y.verify],e=>{let{pageParam:n=1}=e;return o.Z.getAll(p().stringify({page:n,perPage:12,address:t,open:"popular"===k?1:void 0,currency_id:null==c?void 0:c.id,verify:null==y?void 0:y.verify}))},{enabled:"recomended"!==k,getNextPageParam(e){if(e.meta.current_page<e.meta.last_page)return e.meta.current_page+1}}),{data:M,isLoading:N}=(0,d.useQuery)(["recommendedShops",r,t,c,k],()=>o.Z.getRecommended({address:t,currency_id:null==c?void 0:c.id}),{enabled:"recomended"===k}),Z=(0,i.useMemo)(()=>{var e,n;switch(k){case"popular":return(null==x?void 0:null===(e=x.pages)||void 0===e?void 0:e.flatMap(e=>e.data))||[];case"recomended":return(null==M?void 0:M.data)||[];default:return(null==x?void 0:null===(n=x.pages)||void 0===n?void 0:n.flatMap(e=>e.data))||[]}},[x,k,M]),E=(0,i.useCallback)(e=>{let n=e[0];n.isIntersecting&&P&&j()},[]);return(0,i.useEffect)(()=>{let e=new IntersectionObserver(E,{root:null,rootMargin:"20px",threshold:0});l.current&&e.observe(l.current)},[E]),_&&console.log("error => ",_),(0,a.jsxs)("div",{className:"bg-white",children:[(0,a.jsx)(m,{title:function(e){switch(e){case"popular":return n("popular.near.you");case"recomended":return n("daily.offers");default:return n("all")}}(k),shops:Z,loading:G&&!C||N}),C&&(0,a.jsx)(b,{}),(0,a.jsx)("div",{ref:l}),!Z.length&&!G&&!(null==M?void 0:null===(e=M.data)||void 0===e?void 0:e.length)&&!N&&(0,a.jsx)(h,{text:n("no.shops")}),(0,a.jsx)(w,{})]})}},24654:function(){}}]);