(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7437],{47977:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return w}});var a=r(85893),t=r(5152),l=r.n(t),d=r(88767),o=r(1612),u=r(67294),s=r(2950),i=r(18074),c=r(80129),p=r.n(c),g=r(34349),v=r(64698),f=r(11163);let b=l()(()=>Promise.resolve().then(r.bind(r,37935)),{loadableGenerated:{webpack:()=>[37935]}}),h=l()(()=>r.e(520).then(r.bind(r,20520)),{loadableGenerated:{webpack:()=>[20520]}}),m=l()(()=>Promise.all([r.e(9072),r.e(8541)]).then(r.bind(r,13237)),{loadableGenerated:{webpack:()=>[13237]}}),k=l()(()=>Promise.all([r.e(110),r.e(9072),r.e(2175),r.e(7022),r.e(1018),r.e(5630),r.e(5584)]).then(r.bind(r,16515)),{loadableGenerated:{webpack:()=>[16515]}});function w(){var e;let{t:n,locale:r}=(0,i.Z)(),t=(0,u.useRef)(null),l=(0,s.Z)(),c=(0,g.C)(v.j),{query:w}=(0,f.useRouter)(),x=null==w?void 0:w.filter,{data:_,error:j,fetchNextPage:P,hasNextPage:y,isFetchingNextPage:C,isLoading:G}=(0,d.useInfiniteQuery)(["popularShopsPaginate",r,l,c,x],e=>{let{pageParam:n=1}=e;return o.Z.getAll(p().stringify({page:n,perPage:12,address:l,open:"popular"===x?1:void 0,currency_id:null==c?void 0:c.id}))},{enabled:"recomended"!==x,getNextPageParam(e){if(e.meta.current_page<e.meta.last_page)return e.meta.current_page+1}}),{data:M,isLoading:Z}=(0,d.useQuery)(["recommendedShops",r,l,c,x],()=>o.Z.getRecommended({address:l,currency_id:null==c?void 0:c.id}),{enabled:"recomended"===x}),E=(0,u.useMemo)(()=>{var e,n;switch(x){case"popular":return(null==_?void 0:null===(e=_.pages)||void 0===e?void 0:e.flatMap(e=>e.data))||[];case"recomended":return(null==M?void 0:M.data)||[];default:return(null==_?void 0:null===(n=_.pages)||void 0===n?void 0:n.flatMap(e=>e.data))||[]}},[_,x,M]),I=(0,u.useCallback)(e=>{let n=e[0];n.isIntersecting&&y&&P()},[P,y]);return(0,u.useEffect)(()=>{let e=new IntersectionObserver(I,{root:null,rootMargin:"20px",threshold:0});t.current&&e.observe(t.current)},[I]),j&&console.log("error => ",j),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m,{title:function(e){switch(e){case"popular":return n("popular.near.you");case"recomended":return n("trending");default:return n("all.shops")}}(x),shops:E,loading:G&&!C||Z}),C&&(0,a.jsx)(b,{}),(0,a.jsx)("div",{ref:t}),!E.length&&!G&&!(null==M?void 0:null===(e=M.data)||void 0===e?void 0:e.length)&&!Z&&(0,a.jsx)(h,{text:n("no.shops")}),(0,a.jsx)(k,{})]})}},24654:function(){}}]);