(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6113,174],{26711:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var a=r(85893),n=r(67294),o=r(47567),l=r(79072),s=r(77058),i=r(90480),d=r.n(i),c=r(67899),u=r.n(c),p=r(94660),v=r(86555),m=r(4756),f=r.n(m),h=r(21697),_=r(30251),g=r(82175),x=r(24847),b=r.n(x),y=r(60291),j=r(1612),C=r(88767),M=r(29969),k=r(82027),N=r(73714),Z=r(80892);function w(e){var t,r,i,c;let{address:m,latlng:x,editedAddress:w,onClearAddress:P,...L}=e,{t:O}=(0,s.$)(),{user:E}=(0,M.a)(),{updateAddress:S,updateLocation:I,location_id:B,updateLocationId:T}=(0,h.r)(),[z,W]=(0,n.useState)({lat:Number(x.split(",")[0]),lng:Number(x.split(",")[1])}),A=(0,n.useRef)(),{isSuccess:R}=(0,C.useQuery)(["shopZones",z],()=>j.Z.checkZone({address:{latitude:z.lat,longitude:z.lng}})),F=(0,C.useQueryClient)(),{mutate:V,isLoading:Q}=(0,C.useMutation)({mutationFn:e=>k.Z.create(e)}),{mutate:U,isLoading:q}=(0,C.useMutation)({mutationFn:e=>k.Z.update((null==w?void 0:w.id)||0,e)}),{mutate:D,isLoading:G}=(0,C.useMutation)({mutationFn:e=>k.Z.delete(e),async onMutate(e){await F.cancelQueries("addresses");let t=F.getQueryData("addresses");return F.setQueryData("addresses",r=>r?r.flatMap(e=>e).filter(t=>t.id!==e):t),{prevAddresses:t}},onError(e,t,r){F.setQueryData("addresses",null==r?void 0:r.prevAddresses)},onSettled(){L.onClose&&L.onClose({},"backdropClick")}}),H=(0,g.TA)({initialValues:{entrance:null==w?void 0:null===(t=w.address)||void 0===t?void 0:t.entrance,floor:(null==w?void 0:null===(r=w.address)||void 0===r?void 0:r.floor)||"",apartment:(null==w?void 0:null===(i=w.address)||void 0===i?void 0:i.house)||"",comment:null==w?void 0:null===(c=w.address)||void 0===c?void 0:c.comment,title:null==w?void 0:w.title},onSubmit(e,t){let{setSubmitting:r}=t;!function(e){var t,r,a;if(w){U({title:e.title,location:[z.lat,z.lng],address:{address:(null===(t=A.current)||void 0===t?void 0:t.value)||"",floor:e.floor,house:e.apartment,entrance:e.entrance,comment:e.comment||""},active:w.active},{onSuccess(){(0,N.Vp)(O("successfully.updated")),F.invalidateQueries("addresses")},onError(){(0,N.vU)(O("unable.to.save"))},onSettled(){if(B===(null==w?void 0:w.id.toString())){var e;S(null===(e=A.current)||void 0===e?void 0:e.value),I("".concat(z.lat,",").concat(z.lng))}L.onClose&&L.onClose({},"backdropClick")}});return}E?V({title:e.title,location:[z.lat,z.lng],address:{address:(null===(r=A.current)||void 0===r?void 0:r.value)||"",floor:e.floor,house:e.apartment,entrance:e.entrance,comment:e.comment},active:1},{onSuccess(e){(0,N.Vp)(O("successfully.saved")),F.invalidateQueries("addresses"),T(e.id.toString())},onError(){(0,N.vU)(O("unable.to.save"))},onSettled(){var e;S(null===(e=A.current)||void 0===e?void 0:e.value),I("".concat(z.lat,",").concat(z.lng)),L.onClose&&L.onClose({},"backdropClick")}}):(S(null===(a=A.current)||void 0===a?void 0:a.value),I("".concat(z.lat,",").concat(z.lng)),L.onClose&&L.onClose({},"backdropClick"))}(e)},validate:e=>({})});async function K(e){let{coords:t}=e,r="".concat(t.latitude,",").concat(t.longitude),a=await (0,y.K)(r);A.current&&(A.current.value=a);let n={lat:t.latitude,lng:t.longitude};W(n)}return(0,a.jsx)(o.default,{...L,children:(0,a.jsxs)("div",{className:d().wrapper,children:[(0,a.jsxs)("div",{className:d().header,children:[(0,a.jsx)("h1",{className:d().title,children:O("enter.delivery.address")}),(0,a.jsxs)("div",{className:d().flex,children:[(0,a.jsxs)("div",{className:d().search,children:[(0,a.jsx)("label",{htmlFor:"search",children:(0,a.jsx)(u(),{})}),(0,a.jsx)("input",{type:"text",id:"search",name:"search",ref:A,placeholder:O("search"),autoComplete:"off",defaultValue:m})]}),(0,a.jsx)("div",{className:d().btnWrapper,children:(0,a.jsx)(p.Z,{onClick:function(){window.navigator.geolocation.getCurrentPosition(K,console.log)},children:(0,a.jsx)(b(),{})})})]})]}),(0,a.jsx)("div",{className:d().body,children:(0,a.jsx)(v.default,{location:z,setLocation:W,inputRef:A})}),(0,a.jsx)("div",{className:d().form,children:(0,a.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(l.ZP,{item:!0,xs:12,children:(0,a.jsx)(_.Z,{name:"title",label:O("title"),placeholder:O("type.here"),value:H.values.title,onChange:H.handleChange,error:!!H.errors.title&&!!H.touched.title})}),(0,a.jsx)(l.ZP,{item:!0,xs:4,children:(0,a.jsx)(_.Z,{name:"entrance",label:O("entrance"),placeholder:O("type.here"),value:H.values.entrance,onChange:H.handleChange})}),(0,a.jsx)(l.ZP,{item:!0,xs:4,children:(0,a.jsx)(_.Z,{name:"floor",label:O("floor"),placeholder:O("type.here"),value:H.values.floor,onChange:H.handleChange})}),(0,a.jsx)(l.ZP,{item:!0,xs:4,children:(0,a.jsx)(_.Z,{name:"apartment",label:O("apartment"),placeholder:O("type.here"),value:H.values.apartment,onChange:H.handleChange})}),(0,a.jsx)(l.ZP,{item:!0,xs:12,children:(0,a.jsx)(_.Z,{name:"comment",label:O("comment"),placeholder:O("type.here"),value:H.values.comment,onChange:H.handleChange})}),w&&B!==w.id.toString()&&(0,a.jsx)(l.ZP,{item:!0,xs:6,children:(0,a.jsx)(Z.Z,{type:"button",loading:G,onClick:()=>D(w.id),children:O("delete.address")})}),(0,a.jsx)(l.ZP,{item:!0,xs:w&&B!==w.id.toString()?6:12,children:(0,a.jsx)(p.Z,{type:"button",loading:Q||q,onClick:()=>H.submitForm(),disabled:!R,children:R?O("submit"):O("delivery.zone.not.available")})})]})}),(0,a.jsx)("div",{className:d().footer,children:(0,a.jsx)("button",{className:d().circleBtn,onClick(e){L.onClose&&L.onClose(e,"backdropClick")},children:(0,a.jsx)(f(),{})})})]})})}},30251:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var a=r(85893);r(67294);var n=r(67074),o=r(77169);let l=(0,n.ZP)(o.Z)({width:"100%",backgroundColor:"transparent","& .MuiInputLabel-root":{fontSize:12,lineHeight:"14px",fontWeight:500,textTransform:"uppercase",color:"var(--black)",fontFamily:"'Inter', sans-serif",transform:"none","&.Mui-error":{color:"var(--red)"}},"& .MuiInputLabel-root.Mui-focused":{color:"var(--black)"},"& .MuiInput-root":{fontSize:16,fontWeight:500,lineHeight:"19px",color:"var(--black)",fontFamily:"'Inter', sans-serif","&.Mui-error::after":{borderBottomColor:"var(--red)"}},"& .MuiInput-root::before":{borderBottom:"1px solid var(--grey)"},"& .MuiInput-root:hover:not(.Mui-disabled)::before":{borderBottom:"2px solid var(--black)"},"& .MuiInput-root::after":{borderBottom:"2px solid var(--primary)"}});function s(e){return(0,a.jsx)(l,{variant:"standard",InputLabelProps:{shrink:!0},...e})}},86555:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var a=r(85893),n=r(67294),o=r(76725),l=r(9730),s=r.n(l),i=r(5848),d=r(60291),c=r(45122),u=r(90026);let p=e=>(0,a.jsx)("div",{className:s().point,children:(0,a.jsx)("img",{src:"/images/marker.png",width:32,alt:"Location"})}),v=e=>(0,a.jsxs)("div",{className:s().floatCard,children:[(null==e?void 0:e.price)&&(0,a.jsx)("span",{className:s().price,children:(0,a.jsx)(u.Z,{number:e.price})}),(0,a.jsx)("div",{className:s().marker,children:(0,a.jsx)(c.Z,{data:e.shop,size:"small"})})]}),m={fields:["address_components","geometry"],types:["address"]};function f(e){var t,r;let{location:l,setLocation:c=()=>{},readOnly:u=!1,shop:f,inputRef:h,setAddress:_,price:g,drawLine:x,defaultZoom:b=15}=e,y=(0,n.useRef)(),[j,C]=(0,n.useState)(),[M,k]=(0,n.useState)();async function N(e){var t;if(u)return;let r={lat:e.center.lat(),lng:e.center.lng()};c(r);let a=await (0,d.K)("".concat(r.lat,",").concat(r.lng));(null==h?void 0:null===(t=h.current)||void 0===t?void 0:t.value)&&(h.current.value=a),_&&_(a)}let Z=(e,t)=>{if(h&&(y.current=new t.places.Autocomplete(h.current,m),y.current.addListener("place_changed",async function(){let e=await y.current.getPlace(),t=function(e){let t={street_number:"streetNumber",route:"streetName",sublocality_level_1:"city",locality:"city1",administrative_area_level_1:"state",postal_code:"postalCode",country:"country"},r={};e.address_components.forEach(e=>{r[t[e.types[0]]]=e.long_name});let a=[null==r?void 0:r.streetName,null==r?void 0:r.city1,null==r?void 0:r.country];return a.join(", ")}(e),r={lat:e.geometry.location.lat(),lng:e.geometry.location.lng()};c(r),_&&_(t)})),k(e),C(t),f){let r={lat:Number(null===(o=f.location)||void 0===o?void 0:o.latitude)||0,lng:Number(null===(s=f.location)||void 0===s?void 0:s.longitude)||0},a=[l,r],n=new t.LatLngBounds;for(var o,s,i=0;i<a.length;i++)n.extend(a[i]);e.fitBounds(n)}};return(0,n.useEffect)(()=>{if(f&&j){var e,t;let r={lat:Number(null===(e=f.location)||void 0===e?void 0:e.latitude)||0,lng:Number(null===(t=f.location)||void 0===t?void 0:t.longitude)||0},a=[l,r],n=new j.LatLngBounds;for(var o=0;o<a.length;o++)n.extend(a[o]);M.fitBounds(n)}},[l,null==f?void 0:f.location,x,M,j]),(0,a.jsxs)("div",{className:s().root,children:[!u&&(0,a.jsx)("div",{className:s().marker,children:(0,a.jsx)("img",{src:"/images/marker.png",width:32,alt:"Location"})}),(0,a.jsxs)(o.ZP,{bootstrapURLKeys:{key:i.kr||"",libraries:["places"]},zoom:b,center:l,onDragEnd:N,yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded(e){let{map:t,maps:r}=e;return Z(t,r)},options:{fullscreenControl:u},children:[u&&(0,a.jsx)(p,{lat:l.lat,lng:l.lng}),!!f&&(0,a.jsx)(v,{lat:(null===(t=f.location)||void 0===t?void 0:t.latitude)||0,lng:(null===(r=f.location)||void 0===r?void 0:r.longitude)||0,shop:f,price:g})]})]})}},90480:function(e){e.exports={wrapper:"addressModal_wrapper__wd8fr",header:"addressModal_header__NR1NL",title:"addressModal_title__cgd_V",flex:"addressModal_flex__r_MIU",search:"addressModal_search__gcs6f",btnWrapper:"addressModal_btnWrapper__xIPVy",body:"addressModal_body__VAc7I",form:"addressModal_form__lEtUl",footer:"addressModal_footer__VwwZM",circleBtn:"addressModal_circleBtn__Gf8_7",request:"addressModal_request__KdXvo",requestWrapper:"addressModal_requestWrapper__bxgG7",addressButton:"addressModal_addressButton__oTMD5",location:"addressModal_location__nknyf",addressTitle:"addressModal_addressTitle__x7P0a",address:"addressModal_address__AF16M",addressList:"addressModal_addressList__Evyu6",buttonActive:"addressModal_buttonActive__gNbbM"}},9730:function(e){e.exports={root:"map_root__3qcrq",marker:"map_marker__EnBz1",floatCard:"map_floatCard__1zZP1",price:"map_price__CTP0I",point:"map_point__GfLMi"}},92703:function(e,t,r){"use strict";var a=r(50414);function n(){}function o(){}o.resetWarningCache=n,e.exports=function(){function e(e,t,r,n,o,l){if(l!==a){var s=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:n};return r.PropTypes=r,r}},45697:function(e,t,r){e.exports=r(92703)()},50414:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},4756:function(e,t,r){"use strict";var a=r(67294),n=a&&"object"==typeof a&&"default"in a?a:{default:a},o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},l=function(e,t){var r={};for(var a in e)!(t.indexOf(a)>=0)&&Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r},s=function(e){var t=e.color,r=e.size,a=void 0===r?24:r,s=(e.children,l(e,["color","size","children"])),i="remixicon-icon "+(s.className||"");return n.default.createElement("svg",o({},s,{className:i,width:a,height:a,fill:void 0===t?"currentColor":t,viewBox:"0 0 24 24"}),n.default.createElement("path",{d:"M7.828 11H20v2H7.828l5.364 5.364-1.414 1.414L4 12l7.778-7.778 1.414 1.414z"}))},i=n.default.memo?n.default.memo(s):s;e.exports=i},24847:function(e,t,r){"use strict";var a=r(67294),n=a&&"object"==typeof a&&"default"in a?a:{default:a},o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},l=function(e,t){var r={};for(var a in e)!(t.indexOf(a)>=0)&&Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r},s=function(e){var t=e.color,r=e.size,a=void 0===r?24:r,s=(e.children,l(e,["color","size","children"])),i="remixicon-icon "+(s.className||"");return n.default.createElement("svg",o({},s,{className:i,width:a,height:a,fill:void 0===t?"currentColor":t,viewBox:"0 0 24 24"}),n.default.createElement("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm-5-8.5L16 8l-3.5 9.002L11 13l-4-1.5z"}))},i=n.default.memo?n.default.memo(s):s;e.exports=i}}]);